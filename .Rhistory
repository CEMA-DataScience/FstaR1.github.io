separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)#%>%
names(kajiado)
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(owned_dogs, na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 )
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(owned_dogs, na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 )
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(owned_dogs, na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct()
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(as.numeric(owned_dogs), na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct()
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(as.numeric(owned_dogs), na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,vaccination_site,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct()
table(kajiado$vaccination_site)
library(flexdashboard)
#library(sf)
library(rgdal)
library(ggmap)
library(plotly)
library(leaflet)
library(tidyverse)
library(knitr)
library(tidyverse)
library(knitr)
library(janitor)
vaccination_form<-read_csv("Kajiado_MassVaccination_form_20221030.csv")
vaccination_link<-read_csv("Kajiado_MassVaccination_link2_20221030.csv")
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(as.numeric(owned_dogs), na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,vaccination_site,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct()
vaccinated_dogs<- vaccination_link%>%
#separate(owned_dogs, c("owned_dogs1", "owned_dogs2", "owned_dogs3"), ",")%>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.)))
janitor::clean_names()%>%
select(date_created, parent_code, answer_code,vaccinated_dogs1:vaccinated_dogs3)%>%
filter(!(is.na(vaccinated_dogs1) & is.na(vaccinated_dogs2) & is.na(vaccinated_dogs3)))%>%
mutate(id=seq(from=1, by=1,length.out = length(parent_code)))
head(kajiado)
View(kajiado)
?slice
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T)) %>%
mutate(total_owned_dogs=sum(as.numeric(owned_dogs), na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,vaccination_site,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct() %>%
group_by(vaccination_site)%>%
slice_head(n=1)
kajiado
mean(kajiado$distance_km1)
mean(kajiado$distance_km1, na.rm = T)
table(kajiado$total_owned_dogs)
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
#separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
#separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
#separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b), funs(str_remove(.,"[])]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T))#  %>%
table(kajiado$owned_dogs)
View(kajiado)
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
separate(owned_dogs, c("owned_dogs1", "owned_dogs2", "owned_dogs3"), ",")%>%
separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, owned_dogs1b, owned_dogs2b,owned_dogs3b), funs(str_remove(.,"[)]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b,owned_dogs1b, owned_dogs2b,owned_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T))#  %>%
table(kajiado$owned_dogs1b)
kajiado<- left_join(vaccination_form, vaccination_link, by=c("AnswerCode"="ParentCode"))%>%
mutate(vaccination_site=recode(vacc_station_1, "Matasia_chiefs_camp"="Matasia chiefs camp")) %>%
separate(vaccinated_dogs, c("vaccinated_dogs1", "vaccinated_dogs2", "vaccinated_dogs3"), ",")%>%
separate(owned_dogs, c("owned_dogs1", "owned_dogs2", "owned_dogs3"), ",")%>%
separate(owned_dogs1, c("owned_dogs1a", "owned_dogs1b"), sep = "[(]")%>%
separate(owned_dogs2, c("owned_dogs2a", "owned_dogs2b"), "[(]")%>%
separate(owned_dogs3, c("owned_dogs3a", "owned_dogs3b"), "[(]")%>%
separate(vaccinated_dogs1, c("vaccinated_dogs1a", "vaccinated_dogs1b"), "[(]")%>%
separate(vaccinated_dogs2, c("vaccinated_dogs2a", "vaccinated_dogs2b"), "[(]")%>%
separate(vaccinated_dogs3, c("vaccinated_dogs3a", "vaccinated_dogs3b"), "[(]")%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, owned_dogs1b, owned_dogs2b,owned_dogs3b), funs(str_remove(.,"[)]")))%>%
mutate_at(vars(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b,owned_dogs1b, owned_dogs2b,owned_dogs3b),funs(as.numeric(.))) %>%
group_by(vaccination_site)%>%
mutate(total_vaccinated_dogs=sum(vaccinated_dogs1b,vaccinated_dogs2b,vaccinated_dogs3b, na.rm=T))  %>%
mutate(total_owned_dogs=sum(owned_dogs1b, owned_dogs2b,owned_dogs3b, na.rm=T)) %>%
mutate(total_cats=sum(cats_vaccinated, na.rm=T)) %>%
mutate(distance_km1=mean(distance_km, na.rm=T)) %>%
mutate(time_minutes1=mean(time_minutes, na.rm=T)) %>%
ungroup() %>%
select(Latitude.x, Longitude.x,vaccination_site,total_vaccinated_dogs, total_owned_dogs,total_cats,distance_km1, time_minutes1 ) %>%
distinct() %>%
group_by(vaccination_site)%>%
slice_head(n=1)
valueBox(value = round(sum(kajiado$total_owned_dogs)),icon = "fa-dog",caption = "Owned dogs",color = "#d73027")
valueBox(value = sum(kajiado$total_vaccinated_dogs), icon = "fa-syringe",caption = "Vaccinated dogs", color = "#fdae61")
valueBox(value = paste0(round((sum(kajiado$total_vaccinated_dogs)/sum(kajiado$total_owned_dogs)*100)), "%"),icon = "fa-shield-alt",caption = "Proportion of owned dogs vaccinated", color = "#74add1")
valueBox(value = mean(kajiado$distance_km1, na.rm = T),icon = "fa-paw",caption = "Mean distance covered", color = "#4575b4")
valueBox(value = round(mean(kajiado$distance_km1, na.rm = T),1),icon = "fa-paw",caption = "Mean distance covered", color = "#4575b4")
####
cholera_a5 <- read_csv("cholera_above5_data_updated.csv")
names(cholera_a5)
water <- cholera_a5 %>%
select(NAME_2, improved_water, unimproved_Water,surface_water)%>%
distinct()
cholera_b5_clean<- read_csv("below_5_cholera_all.csv") %>%
mutate(pop="<5 years") %>%
left_join(water, by=c("NAME_2"))
write_csv(cholera_B5_clean,"cholera_below5_data_updated.csv")
write_csv(cholera_b5_clean,"cholera_below5_data_updated.csv")
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) )))
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) )))
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) ))) %>%
select(NAME_2, hotspots, rr)
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) ))) %>%
select(NAME_2, hotspots, rr)%>%
mutate(pop="≥5 years")
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) ))) %>%
select(NAME_2, hotspots, rr)
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
distinct()
library(sf)
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
distinct()
hotspots_o5 <- read_csv("cholera_above5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Tharaka", "Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra", "North Horr","Embakasi East","Langata", "Kibra", "Starehe", "Pokot South", "Teso South","Maragwa", "Gatanga", "Kandara", "Kiharu","Embakasi South"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Tharaka"), 3.98, ifelse(NAME_2%in%c("Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra"), 2.02,ifelse(NAME_2%in%c("North Horr"), 3.80, ifelse(NAME_2%in%"Embakasi East", 1.96, ifelse(NAME_2%in%c("Langata", "Kibra", "Starehe"),1.75,ifelse(NAME_2%in%"Pokot South", 2.59,ifelse(NAME_2%in%"Teso South", 1.90, ifelse(NAME_2%in%c("Maragwa", "Gatanga", "Kandara", "Kiharu", 1.58, ifelse(NAME_2%in%"Embakasi South",1.26, NA))))) ))) ))) %>%
select(NAME_2, hotspots, rr)
hotspots_o5 <- read_csv("cholera_above5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Tharaka", "Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra", "North Horr","Embakasi East","Langata", "Kibra", "Starehe", "Pokot South", "Teso South","Maragwa", "Gatanga", "Kandara", "Kiharu","Embakasi South"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Tharaka"), 3.98, ifelse(NAME_2%in%c("Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra"), 2.02,ifelse(NAME_2%in%c("North Horr"), 3.80, ifelse(NAME_2%in%"Embakasi East", 1.96, ifelse(NAME_2%in%c("Langata", "Kibra", "Starehe"),1.75,ifelse(NAME_2%in%"Pokot South", 2.59,ifelse(NAME_2%in%"Teso South", 1.90, ifelse(NAME_2%in%c("Maragwa", "Gatanga", "Kandara", "Kiharu"), 1.58, ifelse(NAME_2%in%"Embakasi South",1.26, NA))))) ))))) %>%
select(NAME_2, hotspots, rr)
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="< years") %>%
distinct()
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="< years") %>%
distinct()
hotspots_o5 <- read_csv("cholera_above5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Tharaka", "Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra", "North Horr","Embakasi East","Langata", "Kibra", "Starehe", "Pokot South", "Teso South","Maragwa", "Gatanga", "Kandara", "Kiharu","Embakasi South"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Tharaka"), 3.98, ifelse(NAME_2%in%c("Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra"), 2.02,ifelse(NAME_2%in%c("North Horr"), 3.80, ifelse(NAME_2%in%"Embakasi East", 1.96, ifelse(NAME_2%in%c("Langata", "Kibra", "Starehe"),1.75,ifelse(NAME_2%in%"Pokot South", 2.59,ifelse(NAME_2%in%"Teso South", 1.90, ifelse(NAME_2%in%c("Maragwa", "Gatanga", "Kandara", "Kiharu"), 1.58, ifelse(NAME_2%in%"Embakasi South",1.26, NA))))) ))))) %>%
select(NAME_2, hotspots, rr)
hotspots_o5 <- read_csv("cholera_above5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Tharaka", "Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra", "North Horr","Embakasi East","Langata", "Kibra", "Starehe", "Pokot South", "Teso South","Maragwa", "Gatanga", "Kandara", "Kiharu","Embakasi South"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Tharaka"), 3.98, ifelse(NAME_2%in%c("Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra"), 2.02,ifelse(NAME_2%in%c("North Horr"), 3.80, ifelse(NAME_2%in%"Embakasi East", 1.96, ifelse(NAME_2%in%c("Langata", "Kibra", "Starehe"),1.75,ifelse(NAME_2%in%"Pokot South", 2.59,ifelse(NAME_2%in%"Teso South", 1.90, ifelse(NAME_2%in%c("Maragwa", "Gatanga", "Kandara", "Kiharu"), 1.58, ifelse(NAME_2%in%"Embakasi South",1.26, NA))))) ))))) %>%
select(NAME_2, hotspots, rr)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
distinct()
hotspots_cholera <- rbind(hotspots_above5, hotspots_under5)
ggplot()+geom_sf(hotspots_cholera, aes(fill=rr))+facet_grid(.~pop)
ggplot(hotspots_cholera)+geom_sf( aes(fill=rr))+facet_grid(.~pop)
table(hotspots_cholera$pop)
table(hotspots_o5$pop)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
distinct()
names(hotspots_o5)
names(hotspots_above5)
head(hotspots_above5\)
head(hotspots_above5)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp")
head(hotspots_above5)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2")
names(hotspots_above5)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
distinct()
names(hotspots_above5)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years") %>%
dplyr::distinct()
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years")
names(hotspots_above5)
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years")  %>%
dplyr::distinct()
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years")
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="< years")
hotspots_cholera <- rbind(hotspots_above5, hotspots_under5)
ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( )+facet_grid(.~pop)
library(tidyverse)
library(sf)
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) ))) %>%
select(NAME_2, hotspots, rr)
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="< years") %>%
distinct()
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
distinct() %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="<5 years")
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="<5 years")
hotspots_u5
hotspots_u5 <- read_csv("cholera_below5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara", "Lagdera","Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea","Pokot South","Dagoretti North", "Kibra"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Kamkunji", "Mathare", "Makadara"), 2.34, ifelse(NAME_2%in%"Lagdera", 3.60,ifelse(NAME_2%in%c("Manyatta", "Runyenjes", "Gichugu", "Kirinyaga Central", "Chuka/Igambang’ombe", "Maara", "Mwea"), 2.25, ifelse(NAME_2%in%"Pokot South", 2.59, ifelse(NAME_2%in%c("Dagoretti North", "Kibra"),2.41, NA ))) ))) %>%
select(NAME_2, hotspots, rr) %>%
distinct()
hotspots_under5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_u5, by="NAME_2") %>%
mutate(pop="<5 years")
hotspots_o5 <- read_csv("cholera_above5_data_updated.csv") %>%
mutate(hotspots=ifelse(NAME_2%in%c("Tharaka", "Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra", "North Horr","Embakasi East","Langata", "Kibra", "Starehe", "Pokot South", "Teso South","Maragwa", "Gatanga", "Kandara", "Kiharu","Embakasi South"), "Yes", "No")) %>%
mutate(rr=ifelse(NAME_2%in%c("Tharaka"), 3.98, ifelse(NAME_2%in%c("Starehe", "Kamkunji", "Makadara", "Mathare", "Kibra"), 2.02,ifelse(NAME_2%in%c("North Horr"), 3.80, ifelse(NAME_2%in%"Embakasi East", 1.96, ifelse(NAME_2%in%c("Langata", "Kibra", "Starehe"),1.75,ifelse(NAME_2%in%"Pokot South", 2.59,ifelse(NAME_2%in%"Teso South", 1.90, ifelse(NAME_2%in%c("Maragwa", "Gatanga", "Kandara", "Kiharu"), 1.58, ifelse(NAME_2%in%"Embakasi South",1.26, NA))))) ))))) %>%
select(NAME_2, hotspots, rr) %>%
distinct()
hotspots_above5<-st_read("Kenya_shapefiles/gadm36_KEN_2.shp") %>%
mutate(NAME_2=recode(NAME_2, "Webute West"="Webuye West")) %>%
left_join(hotspots_o5, by="NAME_2") %>%
mutate(pop="≥5 years")
hotspots_cholera <- rbind(hotspots_above5, hotspots_under5)
ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( )+facet_grid(.~pop)
ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( )+facet_grid(.~pop)
ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")
x<- ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")
v
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr, color=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+ scale_color_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+guides(color=FALSE)+labs(fill="Relative Risk")
ggsave("hotspots_rr_cholera.png",x, width=14 )
table(hotspots_cholera$rr)
x<- ggplot(hotspots_cholera,aes(fill=rr, color=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(breaks=c(0,4,by=4),low="#ffffcc", high="#e31a1c", na.value = "white")+ scale_color_gradient2(breaks=c(0,4,by=4),low="#ffffcc", high="#e31a1c", na.value = "white")+guides(color=FALSE)+labs(fill="Relative Risk")
ggsave("hotspots_rr_cholera.png",x, width=14 )
hotspots_cholera <- rbind(hotspots_above5, hotspots_under5) %>%
mutate(name=ifelse(hotspots%in%"Yes", NAME_2, NA))
x<- ggplot(hotspots_cholera,aes(fill=rr, color=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+ scale_color_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+guides(color=FALSE)+labs(fill="Relative Risk")+geom_sf_text(aes(label=name))
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr, color=rr))+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+ scale_color_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+guides(color=FALSE)+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black")
x
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr), color="grey80", size=0.7)+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black")
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr), color="grey80", size=0.4)+geom_sf( )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black")
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( color="grey80", size=0.4 )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black")
ggsave("hotspots_rr_cholera.png",x, width=14 )
x<- ggplot(hotspots_cholera,aes(fill=rr))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black", check_overlap = T)
ggsave("hotspots_rr_cholera.png",x, width=14 )
View(hotspots_above5)
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("BUSIA", "MARSABIT", "MURANG'A", "NAIROBI"), NAME_1, NA))
View(hspot)
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("Busia", "Marsabit", "Murang'a", "Nairobi"), NAME_1, NA))
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("Busia", "Marsabit", "Murang'a", "Nairobi", "Tharaka-Nithi", "West Pokot"), NAME_1, NA))
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("Busia", "Marsabit", "Murang'a", "Nairobi", "Tharaka-Nithi", "West Pokot"), NAME_1, NA))%>%
mutate(hs=ifelse(!is.na(above5), "Yes", "No"))
ggsave(hspot, aes(fill=hs))+geom_sf()+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north()+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")
ggsave(hspot, aes(fill=hs))+geom_sf()+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north(hspot)+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")
ggsave(hspot, aes(fill=hs))+geom_sf()+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))
table(hspot$hs)
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("Busia", "Marsabit", "Murang'a", "Nairobi", "Tharaka-Nithi", "West Pokot"), NAME_1, NA))%>%
mutate(hs=ifelse(!is.na(above5), "Yes", "No"))
ggsave(hspot, aes(fill=hs))+geom_sf()+theme_void()
ggplot(hspot, aes(fill=hs))+geom_sf()+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north(hspot)+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")
ggsave("hotspots_above_five.png")
ggplot(hspot, aes(fill=hs))+geom_sf(color="grey80", size=0.4)+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north(hspot)+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")+labs(fill="Counties with \n hotspots")
ggsave("hotspots_above_five.png")
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=rr))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=name), color="black", check_overlap = T)
ggsave("busia_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=rr))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_gradient2(low="#ffffcc", high="#e31a1c", na.value = "white")+labs(fill="Relative Risk")+geom_sf_text(aes(label=NAME_2), color="black", check_overlap = T)
X
x
hotspots_above5[hotspots_above5$NAME_1%in%"Busia",]
hotspots_above5 <- hotspots_above5 %>%
mutate(name1=ifelse(is.na(rr),paste0(NAME_2, "\n", rr) ))
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=rr))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("#e31a1c", "white"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
x
hotspots_above5 <- hotspots_above5 %>%
mutate(name1=ifelse(is.na(rr),paste0(NAME_2, "\n", rr), NA ))
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=rr))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("#e31a1c", "white"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
X
x
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("#e31a1c", "white"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
x
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("#e31a1c", "white"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
hotspots_above5 <- hotspots_above5 %>%
mutate(name1=ifelse(!is.na(rr),paste0(NAME_2, "\n", rr), NA ))
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("#e31a1c", "white"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Relative Risk")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
x1
x
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Busia",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("busia_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Marsabit",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("marsabit_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Murang'a",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("muranga_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Nairobi",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("nairobi_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"Tharaka-Nithi",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("tharakanithi_hotspots_a5_cholera.png",x, width=14 )
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"West Pokot",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("westpokot_hotspots_a5_cholera.png",x, width=14 )
ggplot(hspot, aes(fill=hs))+geom_sf(color="grey80", size=0.4)+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north(hspot)+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")+labs(fill="Counties with \n hotspots")+geom_sf_text(aes(label=above5))
ggsave("hotspots_above_five.png")
hotspots_above5 <- hotspots_above5 %>%
mutate(name1=ifelse(!is.na(rr),paste0(NAME_2, "\n", rr), NA )) %>%
mutate(hotspots=ifelse(is.na(hotspots), "No", hotspots))
x<- ggplot(hotspots_above5[hotspots_above5$NAME_1%in%"West Pokot",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("westpokot_hotspots_a5_cholera.png",x, width=14 )
View(hotspots_under5)
hspot<- st_read("Kenya_shapefiles/gadm36_KEN_1.shp") %>%
mutate(above5=ifelse(NAME_1%in%c("Embu", "Garissa", "Kirinyaga", "Nairobi", "Tharaka-Nithi", "West Pokot"), NAME_1, NA))%>%
mutate(hs=ifelse(!is.na(above5), "Yes", "No"))
ggplot(hspot, aes(fill=hs))+geom_sf(color="grey80", size=0.4)+theme_void()+scale_fill_manual(values=c("white", "#e31a1c"))+ggsn::north(hspot)+ggsn::scalebar(hspot, dist =200,dist_unit = "km",transform = T, model = "WGS84", location = "bottomleft")+labs(fill="Counties with \n hotspots")+geom_sf_text(aes(label=above5))
ggsave("hotspots_below_five.png")
hotspots_under5 <- hotspots_under5 %>%
mutate(name1=ifelse(!is.na(rr),paste0(NAME_2, "\n", rr), NA )) %>%
mutate(hotspots=ifelse(is.na(hotspots), "No", hotspots))
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"Embu",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("embu_hotspots_u5_cholera.png",x, width=14 )
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"Garissa",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("garissa_hotspots_u5_cholera.png",x, width=14 )
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"Kirinyaga",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("kirinyaga_hotspots_u5_cholera.png",x, width=14 )
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"Nairobi",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("nairobi_hotspots_u5_cholera.png",x, width=14 )
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"Tharaka-Nithi",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("tharakanithi_hotspots_u5_cholera.png",x, width=14 )
x<- ggplot(hotspots_under5[hotspots_under5$NAME_1%in%"West Pokot",],aes(fill=hotspots))+geom_sf( color="grey80", size=0.3 )+facet_grid(.~pop)+theme_void()+scale_fill_manual(values=c("white","#e31a1c"))+labs(fill="Hotspot")+geom_sf_text(aes(label=name1), color="black", check_overlap = T)
ggsave("westpokot_hotspots_u5_cholera.png",x, width=14 )
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(FactoMineR) #for PCA
library(readxl)
library(mdatools) #for PLSDA
library(factoextra)
## import the dataset
plsda_data <- read_excel("Cytokine_WorkUp_PLSDA.xlsx")
View(plsda_data)
